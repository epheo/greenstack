---

- name: Install needed packages
  become: yes
  package:
    state: latest
    name: vim

- template:
    src: vimrc
    dest: ~/.vimrc

- name: Install Vundle
  shell: |
    if [ ! -d "/home/$USER/.vim/bundle/vundle" ]; then
      git clone https://github.com/VundleVim/Vundle.vim.git \
                ~/.vim/bundle/vundle
    fi
  register: vimplugin_result
  changed_when: "vimplugin_result.stdout != ''"
  
- name: Install Plugins
  shell: "vim +PluginInstall +qall"
  when: "vimplugin_result.stdout != ''"